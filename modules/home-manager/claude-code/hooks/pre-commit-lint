#!/usr/bin/env bash
# Pre-commit hook to run linters before committing

set -e

# Get list of staged files
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM)

# Check for Nix files
NIX_FILES=$(echo "$STAGED_FILES" | grep '\.nix$' || true)
if [ -n "$NIX_FILES" ]; then
    echo "Running nixfmt on staged Nix files..."
    echo "$NIX_FILES" | xargs nixfmt --check 2>/dev/null || {
        echo "Nix files need formatting. Run: nixfmt <files>"
        exit 1
    }
fi

echo "Pre-commit checks passed!"
